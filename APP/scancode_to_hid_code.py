from typing import NamedTuple, Union

# USB HID to PS/2 Scan Code Translation Table
# (HID Usage Page, HID Usage ID, (PS/2 Set 1 Make, PS/2 Set 1 Break, PS/2 Set 2 Make, PS/2 Set 2 Break), Key Name)

class ScanCode(NamedTuple):
    HIDUsagePage: int
    HID_Usage_ID: int
    PS2_Set_1_Make: Union[int, None]
    PS2_Set_1_Break: Union[int, None]
    PS2_Set_2_Make: Union[int, None]
    PS2_Set_2_Break: Union[int, None]
    Key_Name: str

usb_ps2_map = [
    ScanCode(0x01, 0x81, 0xE05E, 0xE0DE, 0xE037, 0xE0F037, 'System Power'),
    ScanCode(0x01, 0x82, 0xE05F, 0xE0DF, 0xE03F, 0xE0F03F, 'System Sleep'),
    ScanCode(0x01, 0x83, 0xE063, 0xE0E3, 0xE05E, 0xE0F05E, 'System Wake'),
    ScanCode(0x07, 0x00, None, None, None, None, 'No Event'),
    ScanCode(0x07, 0x01, 0xFF, None, 0x00, None, 'Overrun Error'),
    ScanCode(0x07, 0x02, 0xFC, None, 0xFC, None, 'POST Fail'),
    ScanCode(0x07, 0x03, None, None, None, None, 'ErrorUndefined'),
    ScanCode(0x07, 0x04, 0x1E, 0x9E, 0x1C, 0xF01C, 'A'),
    ScanCode(0x07, 0x05, 0x30, 0xB0, 0x32, 0xF032, 'B'),
    ScanCode(0x07, 0x06, 0x2E, 0xAE, 0x21, 0xF021, 'C'),
    ScanCode(0x07, 0x07, 0x20, 0xA0, 0x23, 0xF023, 'D'),
    ScanCode(0x07, 0x08, 0x12, 0x92, 0x24, 0xF024, 'E'),
    ScanCode(0x07, 0x09, 0x21, 0xA1, 0x2B, 0xF02B, 'F'),
    ScanCode(0x07, 0x0A, 0x22, 0xA2, 0x34, 0xF034, 'G'),
    ScanCode(0x07, 0x0B, 0x23, 0xA3, 0x33, 0xF033, 'H'),
    ScanCode(0x07, 0x0C, 0x17, 0x97, 0x43, 0xF043, 'I'),
    ScanCode(0x07, 0x0D, 0x24, 0xA4, 0x3B, 0xF03B, 'J'),
    ScanCode(0x07, 0x0E, 0x25, 0xA5, 0x42, 0xF042, 'K'),
    ScanCode(0x07, 0x0F, 0x26, 0xA6, 0x4B, 0xF04B, 'L'),
    ScanCode(0x07, 0x10, 0x32, 0xB2, 0x3A, 0xF03A, 'M'),
    ScanCode(0x07, 0x11, 0x31, 0xB1, 0x31, 0xF031, 'N'),
    ScanCode(0x07, 0x12, 0x18, 0x98, 0x44, 0xF044, 'O'),
    ScanCode(0x07, 0x13, 0x19, 0x99, 0x4D, 0xF04D, 'P'),
    ScanCode(0x07, 0x14, 0x10, 0x90, 0x15, 0xF015, 'Q'),
    ScanCode(0x07, 0x15, 0x13, 0x93, 0x2D, 0xF02D, 'R'),
    ScanCode(0x07, 0x16, 0x1F, 0x9F, 0x1B, 0xF01B, 'S'),
    ScanCode(0x07, 0x17, 0x14, 0x94, 0x2C, 0xF02C, 'T'),
    ScanCode(0x07, 0x18, 0x16, 0x96, 0x3C, 0xF03C, 'U'),
    ScanCode(0x07, 0x19, 0x2F, 0xAF, 0x2A, 0xF02A, 'V'),
    ScanCode(0x07, 0x1A, 0x11, 0x91, 0x1D, 0xF01D, 'W'),
    ScanCode(0x07, 0x1B, 0x2D, 0xAD, 0x22, 0xF022, 'X'),
    ScanCode(0x07, 0x1C, 0x15, 0x95, 0x35, 0xF035, 'Y'),
    ScanCode(0x07, 0x1D, 0x2C, 0xAC, 0x1A, 0xF01A, 'Z'),
    ScanCode(0x07, 0x1E, 0x02, 0x82, 0x16, 0xF016, '1 !'),
    ScanCode(0x07, 0x1F, 0x03, 0x83, 0x1E, 0xF01E, '2 @'),
    ScanCode(0x07, 0x20, 0x04, 0x84, 0x26, 0xF026, '3 #'),
    ScanCode(0x07, 0x21, 0x05, 0x85, 0x25, 0xF025, '4 $'),
    ScanCode(0x07, 0x22, 0x06, 0x86, 0x2E, 0xF02E, '5 %'),
    ScanCode(0x07, 0x23, 0x07, 0x87, 0x36, 0xF036, '6 ^'),
    ScanCode(0x07, 0x24, 0x08, 0x88, 0x3D, 0xF03D, '7 &'),
    ScanCode(0x07, 0x25, 0x09, 0x89, 0x3E, 0xF03E, '8 *'),
    ScanCode(0x07, 0x26, 0x0A, 0x8A, 0x46, 0xF046, '9 ('),
    ScanCode(0x07, 0x27, 0x0B, 0x8B, 0x45, 0xF045, '0 )'),
    ScanCode(0x07, 0x28, 0x1C, 0x9C, 0x5A, 0xF05A, 'Return'),
    ScanCode(0x07, 0x29, 0x01, 0x81, 0x76, 0xF076, 'Escape'),
    ScanCode(0x07, 0x2A, 0x0E, 0x8E, 0x66, 0xF066, 'Backspace'),
    ScanCode(0x07, 0x2B, 0x0F, 0x8F, 0x0D, 0xF00D, 'Tab'),
    ScanCode(0x07, 0x2C, 0x39, 0xB9, 0x29, 0xF029, 'Space'),
    ScanCode(0x07, 0x2D, 0x0C, 0x8C, 0x4E, 0xF04E, '- _'),
    ScanCode(0x07, 0x2E, 0x0D, 0x8D, 0x55, 0xF055, '= +'),
    ScanCode(0x07, 0x2F, 0x1A, 0x9A, 0x54, 0xF054, '[ {'),
    ScanCode(0x07, 0x30, 0x1B, 0x9B, 0x5B, 0xF05B, '] }'),
    ScanCode(0x07, 0x31, 0x2B, 0xAB, 0x5D, 0xF05D, '\\ |'),
    ScanCode(0x07, 0x32, 0x2B, 0xAB, 0x5D, 0xF05D, 'Europe 1 (Note 2)'),
    ScanCode(0x07, 0x33, 0x27, 0xA7, 0x4C, 0xF04C, '; :'),
    ScanCode(0x07, 0x34, 0x28, 0xA8, 0x52, 0xF052, '\' "'),
    ScanCode(0x07, 0x35, 0x29, 0xA9, 0x0E, 0xF00E, '` ~'),
    ScanCode(0x07, 0x36, 0x33, 0xB3, 0x41, 0xF041, ', <'),
    ScanCode(0x07, 0x37, 0x34, 0xB4, 0x49, 0xF049, '. >'),
    ScanCode(0x07, 0x38, 0x35, 0xB5, 0x4A, 0xF04A, '/ ?'),
    ScanCode(0x07, 0x39, 0x3A, 0xBA, 0x58, 0xF058, 'Caps Lock'),
    ScanCode(0x07, 0x3A, 0x3B, 0xBB, 0x05, 0xF005, 'F1'),
    ScanCode(0x07, 0x3B, 0x3C, 0xBC, 0x06, 0xF006, 'F2'),
    ScanCode(0x07, 0x3C, 0x3D, 0xBD, 0x04, 0xF004, 'F3'),
    ScanCode(0x07, 0x3D, 0x3E, 0xBE, 0x0C, 0xF00C, 'F4'),
    ScanCode(0x07, 0x3E, 0x3F, 0xBF, 0x03, 0xF003, 'F5'),
    ScanCode(0x07, 0x3F, 0x40, 0xC0, 0x0B, 0xF00B, 'F6'),
    ScanCode(0x07, 0x40, 0x41, 0xC1, 0x83, 0xF083, 'F7'),
    ScanCode(0x07, 0x41, 0x42, 0xC2, 0x0A, 0xF00A, 'F8'),
    ScanCode(0x07, 0x42, 0x43, 0xC3, 0x01, 0xF001, 'F9'),
    ScanCode(0x07, 0x43, 0x44, 0xC4, 0x09, 0xF009, 'F10'),
    ScanCode(0x07, 0x44, 0x57, 0xD7, 0x78, 0xF078, 'F11'),
    ScanCode(0x07, 0x45, 0x58, 0xD8, 0x07, 0xF007, 'F12'),
    ScanCode(0x07, 0x46, 0xE037, 0xE0B7, 0xE07C, 0xE0F07C, 'Print Screen (Note 1)'),
    ScanCode(0x07, 0x47, 0x46, 0xC6, 0x7E, 0xF07E, 'Scroll Lock'),
    ScanCode(0x07, 0x48, 0xE046E0C6, None, 0xE0F07EE07E, None, 'Break (Ctrl-Pause)'),
    ScanCode(0x07, 0x48, 0xE11D45E19DC5, None, 0xE11477E1F014F077, None, 'Pause'),
    ScanCode(0x07, 0x49, 0xE052, 0xE0D2, 0xE070, 0xE0F070, 'Insert (Note 1)'),
    ScanCode(0x07, 0x4A, 0xE047, 0xE0C7, 0xE06C, 0xE0F06C, 'Home (Note 1)'),
    ScanCode(0x07, 0x4B, 0xE049, 0xE0C9, 0xE07D, 0xE0F07D, 'Page Up (Note 1)'),
    ScanCode(0x07, 0x4C, 0xE053, 0xE0D3, 0xE071, 0xE0F071, 'Delete (Note 1)'),
    ScanCode(0x07, 0x4D, 0xE04F, 0xE0CF, 0xE069, 0xE0F069, 'End (Note 1)'),
    ScanCode(0x07, 0x4E, 0xE051, 0xE0D1, 0xE07A, 0xE0F07A, 'Page Down (Note 1)'),
    ScanCode(0x07, 0x4F, 0xE04D, 0xE0CD, 0xE074, 0xE0F074, 'Right Arrow (Note 1)'),
    ScanCode(0x07, 0x50, 0xE04B, 0xE0CB, 0xE06B, 0xE0F06B, 'Left Arrow (Note 1)'),
    ScanCode(0x07, 0x51, 0xE050, 0xE0D0, 0xE072, 0xE0F072, 'Down Arrow (Note 1)'),
    ScanCode(0x07, 0x52, 0xE048, 0xE0C8, 0xE075, 0xE0F075, 'Up Arrow (Note 1)'),
    ScanCode(0x07, 0x53, 0x45, 0xC5, 0x77, 0xF077, 'Num Lock'),
    ScanCode(0x07, 0x54, 0xE035, 0xE0B5, 0xE04A, 0xE0F04A, 'Keypad / (Note 1)'),
    ScanCode(0x07, 0x55, 0x37, 0xB7, 0x7C, 0xF07C, 'Keypad *'),
    ScanCode(0x07, 0x56, 0x4A, 0xCA, 0x7B, 0xF07B, 'Keypad -'),
    ScanCode(0x07, 0x57, 0x4E, 0xCE, 0x79, 0xF079, 'Keypad +'),
    ScanCode(0x07, 0x58, 0xE01C, 0xE09C, 0xE05A, 0xE0F05A, 'Keypad Enter'),
    ScanCode(0x07, 0x59, 0x4F, 0xCF, 0x69, 0xF069, 'Keypad 1 End'),
    ScanCode(0x07, 0x5A, 0x50, 0xD0, 0x72, 0xF072, 'Keypad 2 Down'),
    ScanCode(0x07, 0x5B, 0x51, 0xD1, 0x7A, 0xF07A, 'Keypad 3 PageDn'),
    ScanCode(0x07, 0x5C, 0x4B, 0xCB, 0x6B, 0xF06B, 'Keypad 4 Left'),
    ScanCode(0x07, 0x5D, 0x4C, 0xCC, 0x73, 0xF073, 'Keypad 5'),
    ScanCode(0x07, 0x5E, 0x4D, 0xCD, 0x74, 0xF074, 'Keypad 6 Right'),
    ScanCode(0x07, 0x5F, 0x47, 0xC7, 0x6C, 0xF06C, 'Keypad 7 Home'),
    ScanCode(0x07, 0x60, 0x48, 0xC8, 0x75, 0xF075, 'Keypad 8 Up'),
    ScanCode(0x07, 0x61, 0x49, 0xC9, 0x7D, 0xF07D, 'Keypad 9 PageUp'),
    ScanCode(0x07, 0x62, 0x52, 0xD2, 0x70, 0xF070, 'Keypad 0 Insert'),
    ScanCode(0x07, 0x63, 0x53, 0xD3, 0x71, 0xF071, 'Keypad . Delete'),
    ScanCode(0x07, 0x64, 0x56, 0xD6, 0x61, 0xF061, 'Europe 2 (Note 2)'),
    ScanCode(0x07, 0x65, 0xE05D, 0xE0DD, 0xE02F, 0xE0F02F, 'App'),
    ScanCode(0x07, 0x66, None, None, None, None, 'Keyboard Power'),
    ScanCode(0x07, 0x67, 0x59, 0xD9, 0x0F, 0xF00F, 'Keypad ='),
    ScanCode(0x07, 0x68, 0x5D, 0xDD, 0x2F, 0xF02F, 'F13'),
    ScanCode(0x07, 0x69, 0x5E, 0xDE, 0x37, 0xF037, 'F14'),
    ScanCode(0x07, 0x6A, 0x5F, 0xDF, 0x3F, 0xF03F, 'F15'),
    # ScanCode(0x07, 0x6B, None, None, None, None, 'F16'),
    # ScanCode(0x07, 0x6C, None, None, None, None, 'F17'),
    # ScanCode(0x07, 0x6D, None, None, None, None, 'F18'),
    # ScanCode(0x07, 0x6E, None, None, None, None, 'F19'),
    # ScanCode(0x07, 0x6F, None, None, None, None, 'F20'),
    # ScanCode(0x07, 0x70, None, None, None, None, 'F21'),
    # ScanCode(0x07, 0x71, None, None, None, None, 'F22'),
    # ScanCode(0x07, 0x72, None, None, None, None, 'F23'),
    # ScanCode(0x07, 0x73, None, None, None, None, 'F24'),
    # ScanCode(0x07, 0x74, None, None, None, None, 'Keyboard Execute'),
    # ScanCode(0x07, 0x75, None, None, None, None, 'Keyboard Help'),
    # ScanCode(0x07, 0x76, None, None, None, None, 'Keyboard Menu'),
    # ScanCode(0x07, 0x77, None, None, None, None, 'Keyboard Select'),
    # ScanCode(0x07, 0x78, None, None, None, None, 'Keyboard Stop'),
    # ScanCode(0x07, 0x79, None, None, None, None, 'Keyboard Again'),
    # ScanCode(0x07, 0x7A, None, None, None, None, 'Keyboard Undo'),
    # ScanCode(0x07, 0x7B, None, None, None, None, 'Keyboard Cut'),
    # ScanCode(0x07, 0x7C, None, None, None, None, 'Keyboard Copy'),
    # ScanCode(0x07, 0x7D, None, None, None, None, 'Keyboard Paste'),
    # ScanCode(0x07, 0x7E, None, None, None, None, 'Keyboard Find'),
    # ScanCode(0x07, 0x7F, None, None, None, None, 'Keyboard Mute'),
    # ScanCode(0x07, 0x80, None, None, None, None, 'Keyboard Volume Up'),
    # ScanCode(0x07, 0x81, None, None, None, None, 'Keyboard Volume Dn'),
    # ScanCode(0x07, 0x82, None, None, None, None, 'Keyboard Locking Caps Lock'),
    # ScanCode(0x07, 0x83, None, None, None, None, 'Keyboard Locking Num Lock'),
    # ScanCode(0x07, 0x84, None, None, None, None, 'Keyboard Locking Scroll Lock'),
    ScanCode(0x07, 0x85, 0x7E, 0xFE, 0x6D, 0xF06D, 'Keypad , (Brazilian Keypad .)'),
    ScanCode(0x07, 0x86, None, None, None, None, 'Keyboard Equal Sign'),
    ScanCode(0x07, 0x87, 0x73, 0xF3, 0x51, 0xF051, "Keyboard Int'l 1 ろ (Ro)"),
    ScanCode(0x07, 0x88, 0x70, 0xF0, 0x13, 0xF013, "Keyboard Int'l 2 かたかな ひらがな ローマ字 (Katakana/Hiragana)"),
    ScanCode(0x07, 0x89, 0x7D, 0xFD, 0x6A, 0xF06A, "Keyboard Int'l 3 ￥ (Yen)"),
    ScanCode(0x07, 0x8A, 0x79, 0xF9, 0x64, 0xF064, "Keyboard Int'l 4 前候補 変換 (次候補) 全候補 (Henkan)"),
    ScanCode(0x07, 0x8B, 0x7B, 0xFB, 0x67, 0xF067, "Keyboard Int'l 5 無変換 (Muhenkan)"),
    ScanCode(0x07, 0x8C, 0x5C, 0xDC, 0x27, 0xF027, "Keyboard Int'l 6 (PC9800 Keypad , )"),
    ScanCode(0x07, 0x8D, None, None, None, None, "Keyboard Int'l 7"),
    ScanCode(0x07, 0x8E, None, None, None, None, "Keyboard Int'l 8"),
    ScanCode(0x07, 0x8F, None, None, None, None, "Keyboard Int'l 9"),
    ScanCode(0x07, 0x90, 0xF2, None, 0xF2, None, 'Keyboard Lang 1 한/영 (Hanguel/English)'),
    ScanCode(0x07, 0x91, 0xF1, 'None', 0xF1, None, 'Keyboard Lang 2 한자 (Hanja)'),
    ScanCode(0x07, 0x92, 0x78, 0xF8, 0x63, 0xF063, 'Keyboard Lang 3 かたかな (Katakana)'),
    ScanCode(0x07, 0x93, 0x77, 0xF7, 0x62, 0xF062, 'Keyboard Lang 4 ひらがな (Hiragana)'),
    ScanCode(0x07, 0x94, 0x76, 0xF6, 0x5F, 0xF05F, 'Keyboard Lang 5 半角/全角 (Zenkaku/Hankaku)'),
    ScanCode(0x07, 0x95, None, None, None, None, 'Keyboard Lang 6'),
    ScanCode(0x07, 0x96, None, None, None, None, 'Keyboard Lang 7'),
    ScanCode(0x07, 0x97, None, None, None, None, 'Keyboard Lang 8'),
    ScanCode(0x07, 0x98, None, None, None, None, 'Keyboard Lang 9'),
    ScanCode(0x07, 0x99, None, None, None, None, 'Keyboard Alternate Erase'),
    ScanCode(0x07, 0x9A, None, None, None, None, 'Keyboard SysReq/Attention'),
    ScanCode(0x07, 0x9B, None, None, None, None, 'Keyboard Cancel'),
    ScanCode(0x07, 0x9C, None, None, None, None, 'Keyboard Clear'),
    ScanCode(0x07, 0x9D, None, None, None, None, 'Keyboard Prior'),
    ScanCode(0x07, 0x9E, None, None, None, None, 'Keyboard Return'),
    ScanCode(0x07, 0x9F, None, None, None, None, 'Keyboard Separator'),
    ScanCode(0x07, 0xA0, None, None, None, None, 'Keyboard Out'),
    ScanCode(0x07, 0xA1, None, None, None, None, 'Keyboard Oper'),
    ScanCode(0x07, 0xA2, None, None, None, None, 'Keyboard Clear/Again'),
    ScanCode(0x07, 0xA3, None, None, None, None, 'Keyboard CrSel/Props'),
    ScanCode(0x07, 0xA4, None, None, None, None, 'Keyboard ExSel'),
    # ScanCode('07', 'A5-DF', ('RESERVED', 'RESERVED', 'RESERVED', 'RESERVED'), 'RESERVED'),
    ScanCode(0x07, 0xE0, 0x1D, '9D', '14', 'F0 14', 'Left Control'),
    ScanCode(0x07, 0xE1, 0x2A, 'AA', '12', 'F0 12', 'Left Shift'),
    ScanCode(0x07, 0xE2, 0x38, 'B8', '11', 'F0 11', 'Left Alt'),
    ScanCode(0x07, 0xE3, 0xE05B, 'E0 DB', 'E0 1F', 'E0 F0 1F'), 'Left GUI'),
    ScanCode(0x07, 0xE4, 0xE01D, 'E0 9D', 'E0 14', 'E0 F0 14'), 'Right Control'),
    ScanCode(0x07, 0xE5, 0x36, 'B6', '59', 'F0 59', 'Right Shift'),
    ScanCode(0x07, 0xE6, 0xE038, 'E0 B8', 'E0 11', 'E0 F0 11'), 'Right Alt'),
    ScanCode(0x07, 0xE7, 0xE05C, 'E0 DC', 'E0 27', 'E0 F0 27'), 'Right GUI'),
    # ScanCode('07', 'E8-FFFF', ('RESERVED', 'RESERVED', 'RESERVED', 'RESERVED'), 'RESERVED'),
    ScanCode(0x0C, 0x00B5, ('E0 19', 'E0 99', 'E0 4D', 'E0 F0 4D'), 'Scan Next Track'),
    ScanCode(0x0C, 0x00B6, ('E0 10', 'E0 90', 'E0 15', 'E0 F0 15'), 'Scan Previous Track'),
    ScanCode(0x0C, 0x00B7, ('E0 24', 'E0 A4', 'E0 3B', 'E0 F0 3B'), 'Stop'),
    ScanCode(0x0C, 0x00CD, ('E0 22', 'E0 A2', 'E0 34', 'E0 F0 34'), 'Play/ Pause'),
    ScanCode(0x0C, 0x00E2, ('E0 20', 'E0 A0', 'E0 23', 'E0 F0 23'), 'Mute'),
    ScanCode(0x0C, 0x00E5, (None, None, None, None), 'Bass Boost'),
    ScanCode(0x0C, 0x00E7, (None, None, None, None), 'Loudness'),
    ScanCode(0x0C, 0x00E9, ('E0 30', 'E0 B0', 'E0 32', 'E0 F0 32'), 'Volume Up'),
    ScanCode(0x0C, 0x00EA, ('E0 2E', 'E0 AE', 'E0 21', 'E0 F0 21'), 'Volume Down'),
    ScanCode(0x0C, 0x0152, (None, None, None, None), 'Bass Up'),
    ScanCode(0x0C, 0x0153, (None, None, None, None), 'Bass Down'),
    ScanCode(0x0C, 0x0154, (None, None, None, None), 'Treble Up'),
    ScanCode(0x0C, 0x0155, (None, None, None, None), 'Treble Down'),
    ScanCode(0x0C, 0x0183, ('E0 6D', 'E0 ED', 'E0 50', 'E0 F0 50'), 'Media Select'),
    ScanCode(0x0C, 0x018A, ('E0 6C', 'E0 EC', 'E0 48', 'E0 F0 48'), 'Mail'),
    ScanCode(0x0C, 0x0192, ('E0 21', 'E0 A1', 'E0 2B', 'E0 F0 2B'), 'Calculator'),
    ScanCode(0x0C, 0x0194, ('E0 6B', 'E0 EB', 'E0 40', 'E0 F0 40'), 'My Computer'),
    ScanCode(0x0C, 0x0221, ('E0 65', 'E0 E5', 'E0 10', 'E0 F0 10'), 'WWW Search'),
    ScanCode(0x0C, 0x0223, ('E0 32', 'E0 B2', 'E0 3A', 'E0 F0 3A'), 'WWW Home'),
    ScanCode(0x0C, 0x0224, ('E0 6A', 'E0 EA', 'E0 38', 'E0 F0 38'), 'WWW Back'),
    ScanCode(0x0C, 0x0225, ('E0 69', 'E0 E9', 'E0 30', 'E0 F0 30'), 'WWW Forward'),
    ScanCode(0x0C, 0x0226, ('E0 68', 'E0 E8', 'E0 28', 'E0 F0 28'), 'WWW Stop'),
    ScanCode(0x0C, 0x0227, ('E0 67', 'E0 E7', 'E0 20', 'E0 F0 20'), 'WWW Refresh'),
    ScanCode(0x0C, 0x022A, ('E0 66', 'E0 E6', 'E0 18', 'E0 F0 18'), 'WWW Favorites'),
]